<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Disco-C: Disco.c, an Async Discord C Bot Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Disco-C
   </div>
   <div id="projectbrief">Discord C Bot Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="disco_8c.html">Disco.c</a>, an Async Discord C Bot Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Disco-C is a part-time project to practice writing bigger projects in C and getting more experience in multiple directions (requests, websockets, APIs, etc.). It is also a nice way to learn about how Discord really works.</p>
<p>The library is built to work async, which means that every received event is handled in its own thread. The idea behind this is, that in a single function you want to work sequentially, but you also don't want functions like sending a message (which does a HTTP request that takes around ~200ms) block the whole bot from receiving anything anymore in that time. Another option would have been to make the HTTP request itself be async, but this then doesn't give you the guarantee that a message has been sent once the message-send function is done.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Wiki</h1>
<p>The wiki is still under developement, but it is available here: <a href="https://markc.su/Disco-C/">https://markc.su/Disco-C/</a></p>
<h1><a class="anchor" id="autotoc_md2"></a>
Table of Contents</h1>
<ol type="1">
<li><a href="#installing">Installing</a><ol type="a">
<li><a href="#copy-paste-command">Copy Paste Command</a></li>
<li><a href="#required-libraries">Required Libraries</a></li>
</ol>
</li>
<li><a href="#file-explanations">File Explanations</a></li>
<li><a href="#progress">Progress</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md3"></a>
Installing</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Copy Paste Command</h2>
<p>Use <code>git clone --recurse-submodules git@github.com:markbeep/Disco-C.git</code> to clone the submodules as well.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Required Libraries:</h2>
<ul>
<li><a href="https://libwebsockets.org/">https://libwebsockets.org/</a><ul>
<li><code>sudo apt install libwebsockets-dev</code></li>
</ul>
</li>
<li><a href="https://curl.se/libcurl/c/">https://curl.se/libcurl/c/</a><ul>
<li><code>sudo apt install libcurl4-gnutls-dev</code></li>
</ul>
</li>
<li><a href="https://github.com/DaveGamble/cJSON/">https://github.com/DaveGamble/cJSON/</a></li>
<li><a href="https://github.com/sheredom/hashmap.h/">https://github.com/sheredom/hashmap.h/</a></li>
<li><a href="https://github.com/ThrowTheSwitch/Unity">https://github.com/ThrowTheSwitch/Unity</a> (optional for testing)</li>
</ul>
<p><em>Note:</em> When building the project yourself, make sure to add <code>-Iinclude -Iexternal -I.</code> to add those three include directories. The local include path is because the <code>config.h</code> with the bot token will be in the local directory. Additionally you'll find the <code>cJSON.c</code> and <code>unity.c</code> files in the <code>external</code> directory.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
File Explanations</h1>
<p>The file layout is intended to follow the Pitchfork standard. Some things aren't yet done (like the main.c file being out in the open), but it's in the making.</p><ul>
<li>src/web/<ul>
<li><b>websocket</b>: Contains the required methods to abstract the background websocket connection.</li>
<li><b>gateway</b>: Handles the websocket connection to the Discord Gateway. Making sure the heartbeat is regularly sent and the incoming responses are all properly handled.</li>
<li><b>request</b>: Helper file that abstracts the HTTP GET/POST/PATCH/etc. requests.</li>
</ul>
</li>
<li>src/utils<ul>
<li><b>cache</b>: The cache uses the <code>hashmap.h</code> library to create a linked hashmap for messages, channels and guilds.</li>
<li><b>disco_logging</b>: Personalized logging library which can be used to log messages to the console. The file path is additionally added to each message.</li>
<li><b><a class="el" href="structprio__queue.html">prio_queue</a></b>: O(n) lazy priority queue implementation. Currently there's no use for this anymore.</li>
<li><b><a class="el" href="structt__pool.html">t_pool</a></b>: Thread pool library to manage the multiple threads which will then be distributed for each fired event.</li>
</ul>
</li>
<li>src/discord/<ul>
<li><b>disco</b>: The main functions of Disco-C. It contains the highest level of abstraction for running the bot.</li>
<li><b>event</b>: Handles received Discord events.</li>
<li><b>structures</b>: All of the Discord structure definitions.</li>
<li>Structure specific functions are all defined in their corresponding source files.</li>
</ul>
</li>
<li><b>examples</b>: Example implementations of how the bot syntax looks like.</li>
<li><b>include</b>: All of the header definitions are in this folder.</li>
<li><b>external</b>: External libraries that are required.</li>
<li><b>docs</b>: Configuration files to automatically generate the wiki.</li>
<li><b>tests</b>: Basic tests which don't really test a lot.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Progress</h1>
<ul>
<li>Interactions <img src="https://progress-bar.dev/100/?title=4/4" alt="" class="inline"/><ul>
<li>[x] Application Command Object</li>
<li>[x] Application Command Option Object</li>
<li>[x] Register Commands<ul>
<li>[x] Global</li>
<li>[x] Guild</li>
</ul>
</li>
<li>[x] Send interaction response</li>
<li>[ ] Components (untested, but implementation exists)</li>
</ul>
</li>
<li>Commands (API Calls)<ul>
<li>Channel <img src="https://progress-bar.dev/11/?title=2/18" alt="" class="inline"/><ul>
<li>[ ] Get channel</li>
<li>[ ] Edit channel<ul>
<li>[ ] Basic stuff (name, desc)</li>
<li>[ ] Add permissions</li>
<li>[ ] Remove permissions</li>
</ul>
</li>
<li>[ ] Delete channel</li>
<li>[ ] Get channel message</li>
<li>[x] Send message<ul>
<li>[x] Content</li>
<li>[x] Embeds</li>
<li>[ ] Components</li>
<li>[ ] Attachments</li>
</ul>
</li>
<li>[x] Edit message</li>
<li>[ ] Delete message</li>
<li>[ ] Bulk delete messages</li>
<li>[ ] Add reaction</li>
<li>[ ] View reactions</li>
<li>[ ] Delete reactions<ul>
<li>[ ] Own</li>
<li>[ ] User</li>
<li>[ ] All</li>
</ul>
</li>
<li>[ ] Create channel invite</li>
<li>[ ] Get channel invites</li>
<li>[ ] Trigger typing indicator</li>
<li>[ ] Get pinned messages</li>
<li>[ ] Pin message</li>
<li>[ ] Unpin message</li>
<li>[ ] Group DM add/remove recipient</li>
<li>Thread <img src="https://progress-bar.dev/0/?title=0/12" alt="" class="inline"/><ul>
<li>[ ] Start thread from message</li>
<li>[ ] Start thread without message</li>
<li>[ ] Start thread in forum channel</li>
<li>[ ] Join thread</li>
<li>[ ] Leave thread</li>
<li>[ ] Add thread member</li>
<li>[ ] Remove thread member</li>
<li>[ ] Get thread member</li>
<li>[ ] List thread members</li>
<li>[ ] List public threads</li>
<li>[ ] List private threads</li>
<li>[ ] List joined private threads</li>
</ul>
</li>
</ul>
</li>
<li>Emoji <img src="https://progress-bar.dev/0/?title=0/5" alt="" class="inline"/><ul>
<li>[ ] List guild emojis</li>
<li>[ ] Get guild emoji</li>
<li>[ ] Create guild emoji</li>
<li>[ ] Modify guild emoji</li>
<li>[ ] Delete guild emoji</li>
</ul>
</li>
<li>Guild (way too many functions to list)</li>
<li>Guild Scheduled Event <img src="https://progress-bar.dev/0/?title=0/5" alt="" class="inline"/><ul>
<li>[ ] Create guild event</li>
<li>[ ] Get guild event</li>
<li>[ ] Edit guild event</li>
<li>[ ] Delete guild event</li>
<li>[ ] Get event users</li>
</ul>
</li>
<li>User <img src="https://progress-bar.dev/0/?title=0/7" alt="" class="inline"/><ul>
<li>[ ] Get (current) user</li>
<li>[ ] Modify current user</li>
<li>[ ] Get current guilds</li>
<li>[ ] Get current guild member</li>
<li>[ ] Leave guild</li>
<li>[ ] Create DM</li>
<li>[ ] Create group DM</li>
</ul>
</li>
<li>... (no complete list of methods yet)</li>
</ul>
</li>
<li>Events <img src="https://progress-bar.dev/14/?title=8/57" alt="" class="inline"/><ul>
<li>[x] READY</li>
<li>[ ] RESUMED</li>
<li>[ ] RECONNECT</li>
<li>[ ] INVALID_SESSION</li>
<li>[ ] APPLICATION_COMMAND_PERMISSIONS_UPDATE</li>
<li>[x] CHANNEL_CREATE</li>
<li>[x] CHANNEL_UPDATE</li>
<li>[x] CHANNEL_DELETE</li>
<li>[ ] CHANNEL_PINS_UPDATE</li>
<li>[ ] THREAD_CREATE</li>
<li>[ ] THREAD_UPDATE</li>
<li>[ ] THREAD_DELETE</li>
<li>[ ] THREAD_LIST_SYNC</li>
<li>[ ] THREAD_MEMBER_UPDATE</li>
<li>[ ] THREAD_MEMBERS_UPDATE</li>
<li>[ ] GUILD_CREATE</li>
<li>[ ] GUILD_UPDATE</li>
<li>[ ] GUILD_DELETE</li>
<li>[ ] GUILD_BAN_ADD</li>
<li>[ ] GUILD_BAN_REMOVE</li>
<li>[ ] GUILD_EMOJIS_UPDATE</li>
<li>[ ] GUILD_STICKERS_UPDATE</li>
<li>[ ] GUILD_INTEGRATIONS_UPDATE</li>
<li>[ ] GUILD_MEMBER_ADD</li>
<li>[ ] GUILD_MEMBER_REMOVE</li>
<li>[ ] GUILD_MEMBER_UPDATE</li>
<li>[ ] GUILD_MEMBERS_CHUNK</li>
<li>[ ] GUILD_ROLE_CREATE</li>
<li>[ ] GUILD_ROLE_UPDATE</li>
<li>[ ] GUILD_ROLE_DELETE</li>
<li>[ ] GUILD_SCHEDULED_EVENT_CREATE</li>
<li>[ ] GUILD_SCHEDULED_EVENT_UPDATE</li>
<li>[ ] GUILD_SCHEDULED_EVENT_DELETE</li>
<li>[ ] GUILD_SCHEDULED_EVENT_USER_ADD</li>
<li>[ ] GUILD_SCHEDULED_EVENT_USER_REMOVE</li>
<li>[ ] INTEGRATION_CREATE</li>
<li>[ ] INTEGRATION_UPDATE</li>
<li>[ ] INTEGRATION_CREATE</li>
<li>[ ] INVITE_CREATE</li>
<li>[ ] INVITE_DELETE</li>
<li>[x] MESSAGE_CREATE</li>
<li>[x] MESSAGE_UPDATE</li>
<li>[x] MESSAGE_DELETE</li>
<li>[ ] MESSAGE_DELETE_BULK</li>
<li>[ ] MESSAGE_REACTION_ADD</li>
<li>[ ] MESSAGE_REACTION_REMOVE</li>
<li>[ ] MESSAGE_REACTION_REMOVE_ALL</li>
<li>[ ] MESSAGE_REACTION_REMOVE_EMOJI</li>
<li>[ ] PRESENCE_UPDATE</li>
<li>[ ] STAGE_INSTANCE_CREATE</li>
<li>[ ] STAGE_INSTANCE_DELETE</li>
<li>[ ] STAGE_INSTANCE_UPDATE</li>
<li>[ ] TYPING_START</li>
<li>[ ] USER_UPDATE</li>
<li>[ ] VOICE_STATE_UPDATE</li>
<li>[ ] VOICE_SERVER_UPDATE</li>
<li>[ ] WEBHOOKS_UPDATE</li>
<li>[x] INTERACTION_CREATE </li>
</ul>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
